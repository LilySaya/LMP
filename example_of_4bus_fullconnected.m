H = diag([0.01, 0.05, 0.1, 0.07, 0.09, 0.03])
H = inv(H)
A = [1, -1, 0, 0;
     0, 1, -1, 0;
     0, 0, 1, -1;
     -1, 0, 0, 1;
     1, 0, -1, 0;
     0, 1, 0, -1]
X = H*A
B_susceptance = [H(1,1)+H(5,5)+H(4,4), -H(1,1), -H(5,5), -H(4,4);
                 -H(1,1), H(1,1)+H(2,2)+H(6,6), -H(2,2), -H(6,6);
                 -H(5,5), -H(2,2), H(5,5)+H(2,2)+H(3,3), -H(3,3);
                 -H(4,4), -H(6,6), -H(3,3), H(4,4)+H(6,6)+H(3,3)]
B_susceptance_prime = B_susceptance(1:3,1:3)
temp = [inv(B_susceptance_prime), zeros(3,1);zeros(1,3), 0]
T = X*temp